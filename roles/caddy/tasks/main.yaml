- name: Create apps directory
  ansible.builtin.file:
    path: /apps
    state: directory

- name: Create caddy directory
  ansible.builtin.file:
    path: /apps/caddy
    state: directory

- name: Create a network
  ansible.builtin.docker_network:
    name: proxy-network

- name: copy caddy docker-compose file
  ansible.builtin.template:
    src: "{{item}}"
    dest: /apps/caddy/.
  with_fileglob: "{{role_path}}/templates/*"
  notify:
    - Restart caddy

- name: Start caddy with docker-compose
  community.docker.docker_compose_v2:
    project_src: /apps/caddy